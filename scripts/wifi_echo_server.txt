main:
# Start Access Point
SET WIFI_SSID "testing-esp32"
SET WIFI_PASSWORD "mytestingpassword11"
SET WIFI_CHANNEL 3
SET WIFI_SSID_HIDDEN 0
SET WIFI_MAX_CONNECTION 1
SET WIFI_CMD 4
SPRINTLN "Enable AP"
SYS 10
# Print IP Address
SET WIFI_CMD 12
SYS 10
SPRINTLN WIFI_SOFTAPIP
CALL wconnected
---
wconnected:
# Print IP Address
SET WIFI_CMD 9
SYS 10
SPRINTLN WIFI_LOCALIP
# Create server
SET WIFI_SERVER_PORT 1234
SET WIFI_SERVER_CMD 1
SPRINTLN "Echo server on 1234"
SYS 11
CALL wait_for_client
---
wait_for_client:
SET WIFI_SERVER_CMD 2
SYS 11
CMP WIFI_CLIENT 1.0
JE connected
SLEEP 1000
GOTO 0
---
connected:
SET WIFI_SERVER_CMD 3
SYS 11
SPRINTLN WIFI_CLIENT_CONNECTED
CMP WIFI_CLIENT_CONNECTED 1.0
JE echo_get
SLEEP 10
GOTO 0
---
echo_get:
SET WIFI_SERVER_CMD 6
SYS 11
CMP WIFI_CLIENT_READLINE ""
JNE echo_send
GOTO 0
---
echo_send:
SPRINTLN WIFI_CLIENT_READLINE
SET WIFI_CLIENT_PRINTLN WIFI_CLIENT_READLINE
SET WIFI_SERVER_CMD 8
SYS 11
CALL echo_get
---
